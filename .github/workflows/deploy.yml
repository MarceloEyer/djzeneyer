          if echo 'Deploy test' > "$FILE_PATH" 2>/tmp/write_err.log; then
            echo "âœ… Wrote test file: $FILE_PATH"
          else
            ERR=$(cat /tmp/write_err.log || true)
            echo "âš ï¸ Direct write failed: $ERR"
            if command -v sudo >/dev/null 2>&1; then
              echo "Attempting with sudo..."
              echo 'Deploy test' | sudo tee "$FILE_PATH" >/dev/null && sudo chmod 664 "$FILE_PATH" && echo "âœ… Wrote with sudo"
            else
              echo "âŒ Cannot escalate privileges and write failed"
              exit 1
            fi
          fi
          ls -l "$FILE_PATH" || true
          echo "File content:" && head -n 5 "$FILE_PATH" || true
          BASH_EOF
      - 
name: 
ğŸ§¹ Cleanup SSH
        if
: 
always()
        run
: 
|
          rm -f ~/.ssh/id_rsa ~/.ssh/config
          echo "ğŸ§¹ SSH credentials cleaned"
      - 
name
: 
ğŸ“Š Deployment summary
        if
: 
always()
        run
: 
|
          echo ""
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
          echo "âœ… DEPLOY SUCCESSFUL"
          echo ""
          echo "ğŸŒ Site: https://djzeneyer.com"
          echo "ğŸ“¦ Build: ${{ needs.validate.outputs.commit_hash }}"
          echo "ğŸ“Š Size: ${{ needs.build.outputs.build_size }}"
          echo "â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
  health-check
:
    name
: 
ğŸ¥ Health Check
    runs-on
: 
ubuntu-latest
    timeout-minutes
: 
5
    needs
: 
deploy
    if
: 
needs.deploy.result == 
'success'
    steps
:
      - 
name
: 
ğŸ” Check site accessibility
        run
: 
|
          echo "Checking https://djzeneyer.com..."
          for i in {1..3}; do
            HTTP_CODE=$(curl -s -o /dev/null -w "%{http_code}" -L --max-time 15 https://djzeneyer.com)
            if [ "$HTTP_CODE" = "200" ]; then
              echo "âœ… Site is accessible (HTTP $HTTP_CODE)"
              exit 0
            else
              echo "Attempt $i failed (HTTP $HTTP_CODE). Retrying in 5s..."
              sleep 5
            fi
          done
          echo "âŒ Site is not accessible after retries"
          exit 1
