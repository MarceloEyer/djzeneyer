# DJ Zen Eyer Theme - AI Context Guide

## 🎯 **Projeto**
Tema WordPress Headless profissional para DJ Zen Eyer (produtor musical brasileiro), com React 18, TypeScript, Vite, gamificação e integração completa com plataformas de streaming (Spotify, Mixcloud, YouTube).

**Versão Atual:** 12.1.0 (Production)  
**Data:** 30/10/2025  
**Status:** ✅ Production Ready

---

## 📁 **Arquitetura**

### Backend (WordPress)
functions.php (v12.1.0)
├── Asset enqueue (React + CSS)
├── REST API endpoints (/wp-json/djz/v1/*)
├── Security headers
├── CORS configuration
└── Custom post types

inc/djz-config.php (v1.2.0) ⭐ CENTRALIZED CONFIG
├── Social media URLs
├── Site metadata
├── AI context
├── Colors (Tailwind)
├── Analytics IDs
├── Features flags
└── Contact info

inc/djz-helpers.php
├── djz_config() → getter function
├── djz_social_urls() → social links
├── djz_allowed_origins() → CORS
├── djz_theme_colors_css() → CSS vars
└── djz_feature_enabled() → features

text

### Frontend (React + Vite)
src/
├── main.tsx → React entry
├── App.tsx → Root component
├── components/
│ ├── Hero.tsx
│ ├── Player.tsx
│ ├── SocialLinks.tsx
│ └── ...
├── styles/
│ └── globals.css (Tailwind)
└── types/
└── config.ts

vite.config.ts
├── Code splitting (manualChunks)
├── Tree shaking (minify: terser)
├── Asset optimization
└── Environment variables

dist/ (Build output)
├── .vite/manifest.json
├── js/ (chunks)
├── css/ (optimized)
└── images/ (compressed)

text

---

## 🔒 **Segurança (v12.1.0 - Implementado)**

### CSP Nonce Implementation
**Arquivo:** `functions.php` (linhas 194-201)
// Inline style recebe CSP nonce
echo '<style id="djz-theme-colors" nonce="' . esc_attr(djzeneyer_get_csp_nonce()) . '">'

text
**Por quê:** Previne XSS em estilos inline (Content Security Policy)

### REST API Security
**Arquivo:** `functions.php` (linhas 208-252)
// Endpoint público retorna APENAS dados públicos
/wp-json/djz/v1/config → Name, tagline, colors (SEM emails, APIs)

// Endpoint admin retorna DADOS COMPLETOS
/wp-json/djz/v1/admin/config → Requer autenticação (manage_options)

text
**Por quê:** Evita exposição de configurações sensíveis

### CORS Configuration
**Arquivo:** `inc/djz-config.php` (linhas 128-132)
'allowed_origins' => [
'https://djzeneyer.com',
'https://www.djzeneyer.com',
'https://app.djzeneyer.com',
// Localhost REMOVIDO (production-only)
]

text
**Por quê:** Reduz vetores de ataque, simplifica workflow (GitHub/Bolt/Hostinger)

---

## 📊 **Configuration Management**

### Single Source of Truth
**Arquivo:** `inc/djz-config.php`

**Para ADICIONAR nova configuração:**
1. Edite `inc/djz-config.php`
2. Adicione nova chave no array
3. Acesse via `djz_config('section.key')`
4. Não hardcode valores em outros arquivos

**Exemplo:**
// inc/djz-config.php
'analytics' => [
'google_analytics' => 'G-XXXXX', // ← UPDATE AQUI
]

// Acesso no código
$ga_id = djz_config('analytics.google_analytics');

text

---

## 🚀 **Deployment Workflow**

Você edita em GitHub/Bolt.new
↓
Git push para main branch
↓
Webhook dispara build
↓
npm run build (Vite)
↓
Hostinger recebe arquivos
↓
Site djzeneyer.com atualiza

text

**Importante:** 
- Nenhum desenvolvimento local necessário
- Sem `npm install` ou `git clone` no laptop
- Bolt.new cuida do build automaticamente
- Deploy é instantâneo após commit

---

## 🧪 **Testing Checklist**

### Após Update
1. [ ] Commit para GitHub
2. [ ] Aguarde webhook build (~2min)
3. [ ] Abra https://djzeneyer.com
4. [ ] F12 → Console (sem erros)
5. [ ] Rode PageSpeed Insights
6. [ ] Rode Security Headers check

### Testing Tools (Recomendados)
- PageSpeed Insights: `https://pagespeed.web.dev`
- Security Headers: `https://securityheaders.com`
- Schema Validator: `https://validator.schema.org`
- GTmetrix: `https://gtmetrix.com`
- Lighthouse: DevTools (F12)

---

## 📝 **Common Tasks**

### Task 1: Adicionar Social Network
**Arquivo:** `inc/djz-config.php`
'social' => [
'instagram' => 'https://...',
'tiktok' => 'https://...', // ← NOVA REDE
]

text
Commit → Deploy → Disponível em `djzConfig.social.tiktok` (JS)

### Task 2: Alterar Cores do Tema
**Arquivo:** `inc/djz-config.php`
'colors' => [
'primary' => '#0A0E27', // ← MUDE AQUI
'accent' => '#3B82F6',
]

text
Commit → Deploy → CSS vars atualizam automaticamente

### Task 3: Habilitar/Desabilitar Feature
**Arquivo:** `inc/djz-config.php`
'features' => [
'gamipress' => false, // ← TOGGLE
]

text
Commit → Deploy → GamiPress desabilitado via `djz_feature_enabled('gamipress')`

### Task 4: Adicionar Analytics
**Arquivo:** `inc/djz-config.php`
'analytics' => [
'google_analytics' => 'G-XXXXX', // ← ID
]

text
Commit → Deploy → Google Analytics ativo

---

## 🔧 **Debugging**

### CSP Issues
Console Error: Refused to load stylesheet
→ Verifique se style tag tem nonce="..."
→ Veja functions.php linhas 194-201

text

### CORS Errors
Console Error: Access to XMLHttpRequest blocked by CORS
→ Verifique if domain está em inc/djz-config.php allowed_origins
→ Confirm CORS header em functions.php linhas 107-119

text

### REST API 404
GET /wp-json/djz/v1/config → 404
→ Verifique se WordPress está com REST API habilitada
→ Verifique se djz-helpers.php está sendo carregado

text

### Build Fails
npm run build → Error
→ Veja Vite logs para detalhes
→ Verific se vite.config.ts está correto
→ Check tsconfig.json strict mode

text

---

## 📚 **Code Snippets for Bolt.new**

### Adicionar Nova Feature Flag
// Em inc/djz-config.php
'features' => [
'minha_feature' => true, // ← NOVA
],

// Em functions.php ou componente
if (djz_feature_enabled('minha_feature')) {
// Lógica aqui
}

text

### Criar Novo REST Endpoint
// Em functions.php, dentro de add_action('rest_api_init')
register_rest_route('djz/v1', '/meu-endpoint', [
'methods' => 'GET',
'callback' => function() {
return rest_ensure_response([
'data' => 'aqui',
]);
},
'permission_callback' => '__return_true', // ou current_user_can()
]);

text

### Acessar Config em React
// src/components/MyComponent.tsx
const config = window.djzConfig; // globalThis via wp_localize_script

console.log(config.siteName);
console.log(config.social.instagram);
console.log(config.colors.primary);

text

---

## 🎯 **Próximos Passos (Melhorias Futuras)**

- [ ] Implementar lazy loading com React.lazy()
- [ ] Verificar bundle size (target: <300KB JS, <100KB CSS)
- [ ] Adicionar caching strategy
- [ ] Implementar PWA (Progressive Web App)
- [ ] Adicionar tests (Jest + React Testing Library)
- [ ] Documentar API endpoints com Swagger
- [ ] Implementar CI/CD pipeline completo
- [ ] Adicionar E2E tests (Cypress)

---

## 📞 **Support & Resources**

- **GitHub:** https://github.com/seu-usuario/djzeneyer-theme
- **Site:** https://djzeneyer.com
- **Email:** contato@djzeneyer.com

---

## 🏆 **Quality Metrics (Target)**

| Métrica | Target | Check Tool |
|---------|--------|-----------|
| Performance Score | 90+ | PageSpeed Insights |
| SEO Score | 95+ | PageSpeed Insights |
| Security Grade | A+ | SecurityHeaders.com |
| Bundle Size JS | <300KB | Vite build analysis |
| Bundle Size CSS | <100KB | Vite build analysis |
| Accessibility | >95 | Lighthouse |
| CSP Compliance | Pass | DevTools Console |
| Schema.org Valid | Yes | Validator.schema.org |

---

**Last Updated:** 30/10/2025 @ 11:50 AM  
**Maintained by:** DJ Zen Eyer Team  
**Status:** ✅ Production Ready